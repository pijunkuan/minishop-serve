(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-611a5944"],{"5fdb":function(t,e,s){"use strict";var a=s("86b2"),o=s.n(a);o.a},"86b2":function(t,e,s){},b343:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("page-loading",{attrs:{loading:t.loading}}),s("div",{staticClass:"checksuc-header"},[t._v(" 订单提交成功 ")]),s("div",{staticClass:"checksuc-amount"},[s("div",[t._v("应付金额")]),s("div",[t._v("¥ "),s("strong",[t._v(t._s(t.order.total_amount?t.order.total_amount:"-"))])])]),s("div",{staticClass:"checksuc-payment"},[s("div",[t._v("支付方式")]),s("div",[s("div",{on:{click:t.changePay}},[t._v(t._s("wallet"===t.payment.code?t.payment.title+" 余额：¥ "+t.$store.getters.balance:t.payment.title)),s("span",{staticClass:"checksuc-payment-select"},[t._v(">")])]),s("div",{staticClass:"checksuc-button"},[s("div",[s("shop-button",{attrs:{size:"small",type:"border"},on:{click:t.toOrders}},[t._v("稍后支付")])],1),s("div",[s("shop-button",{attrs:{size:"small",disabled:t.btnLoading},on:{click:t.toPay}},[t._v("立即支付")])],1)])])]),s("div",{staticClass:"checksuc-content"},[s("div",{staticClass:"checksuc-content-header"},[t._v("订单详情")]),s("div",{staticClass:"checksuc-content-content"},[s("div",[t._v("订单号")]),s("div",[t._v(t._s(t.order.order_no))])]),s("div",{staticClass:"checksuc-content-content"},[s("div",[t._v("收件地址")]),s("div",[s("div",[t._v(t._s(t.order.address.name))]),s("div",[t._v(t._s(t.order.address.mobile))]),s("div",[t._v(t._s(t.order.address.address))])])]),t._l(t.order.items,(function(e,a){return s("div",{key:a,staticClass:"checksuc-content-item"},[s("div",[s("shop-image",{attrs:{type:"fit",src:e.src,width:60,rounded:""}},[s("div",{staticClass:"checksuc-image-placeholder",attrs:{slot:"error"},slot:"error"}),s("div",{staticClass:"checksuc-image-placeholder",attrs:{slot:"placeholder"},slot:"placeholder"})])],1),s("div",[s("div",{staticClass:"checksuc-content-item__title"},[t._v(t._s(e.product_title))]),s("div",{staticClass:"checksuc-content-item__subtitle"},[t._v(t._s(e.variant_title))]),s("div",{staticClass:"checksuc-content-item__price"},[t._v("¥ "),s("strong",[t._v(t._s(e.price))])]),s("div",{staticClass:"checksuc-content-item__amount"},[t._v("x "+t._s(e.quantity))])])])}))],2),s("shop-popup",{attrs:{size:"medium",show:t.payShow},on:{close:t.closePay}},[s("div",{attrs:{slot:"title"},slot:"title"},[t._v("选择支付方式")]),s("div",{attrs:{slot:"content"},slot:"content"},[s("mt-picker",{ref:"pays",attrs:{slots:t.slots}})],1),s("div",{staticClass:"pay-popup-button",attrs:{slot:"button"},slot:"button"},[s("div",[s("shop-button",{attrs:{type:"border",rounded:!1},on:{click:t.closePay}},[t._v("关闭")])],1),s("div",[s("shop-button",{attrs:{rounded:!1},on:{click:t.confirmChange}},[t._v("确定")])],1)])])],1)},o=[],n=(s("d81d"),s("d3b7"),s("ddb0"),s("f8b7")),c=s("b933"),i=s("76a0"),r={data:function(){return{loading:!1,payments:[],payment:{},order:{order_no:"",address:{},items:[],total_amount:0},payShow:!1,slots:[{flex:1,values:[],textAlign:"center"}],btnLoading:!1}},created:function(){this.getOrder(),this.$store.dispatch("getBalance")},methods:{getOrder:function(){var t=this;this.loading=!0,this.order.order_no=this.$route.query.no,Object(n["e"])(this.$route.query.no).then((function(e){"pending"!==e.data.body.status?(Object(i["Toast"])({message:"订单"+("processing"===e.data.body.status?"已付款":"closed"===e.data.body.status||"cancel"===e.data.body.status?"已关闭":"有误")+"，将跳转至订单列表",duration:2e3}),setTimeout((function(){t.loading=!1,t.$router.push({name:"UserOrder"})}),2e3)):Object(c["b"])().then((function(s){t.payments=s.data.body,t.payment=t.payments[0],t.order.address=e.data.body.address,t.order.items=e.data.body.items,t.order.total_amount=e.data.body.amount,t.loading=!1})).catch((function(){t.loading=!1}))})).catch((function(){t.loading=!1}))},changePay:function(){var t=this;this.payShow=!0,this.payments.map((function(e){t.slots[0].values.push(e.title)}))},closePay:function(){this.payShow=!1,this.slots[0].values=[]},confirmChange:function(){var t=this,e=this.$refs.pays.values[0];this.payments.map((function(s){s.title===e&&(t.payment=s)})),this.payShow=!1,this.slots[0].values=[]},toOrders:function(){this.$router.push({name:"UserOrder"})},toPay:function(){var t=this;"wallet"===this.payment.code&&this.order.total_amount>this.$store.getters.balance?Object(i["Toast"])("余额不足"):(this.btnLoading=!0,this.loading=!0,Object(n["d"])(this.$route.query.no,this.payment.code).then((function(e){"success"===e.data.body.status?t.$router.push({name:"Checksuc"}):location.href=e.data.body.pay_url})).catch((function(){t.btnLoading=!1,t.loading=!1})))}}},d=r,u=(s("5fdb"),s("2877")),l=Object(u["a"])(d,a,o,!1,null,"7da5ff3d",null);e["default"]=l.exports},f8b7:function(t,e,s){"use strict";s.d(e,"a",(function(){return o})),s.d(e,"c",(function(){return n})),s.d(e,"d",(function(){return c})),s.d(e,"f",(function(){return i})),s.d(e,"e",(function(){return r})),s.d(e,"b",(function(){return d}));var a=s("b775");function o(t){return Object(a["a"])({url:"order/calc",method:"post",data:t})}function n(t){return Object(a["a"])({url:"order",method:"post",data:t})}function c(t,e){return Object(a["a"])({url:"order/"+t+"/pay/"+e,method:"post"})}function i(t){return Object(a["a"])({url:"order",method:"get",params:t})}function r(t){return Object(a["a"])({url:"order/"+t,method:"get"})}function d(t,e){return Object(a["a"])({url:"order/"+t,method:"put",data:e})}}}]);