(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-556c26b4"],{"14d6":function(t,e,i){"use strict";var n=i("b76d"),s=i.n(n);s.a},2350:function(t,e,i){},"4c79":function(t,e,i){"use strict";i.d(e,"b",(function(){return s})),i.d(e,"a",(function(){return a})),i.d(e,"c",(function(){return o}));var n=i("b775");function s(t){return Object(n["a"])({url:"product",method:"get",params:t})}function a(t){return Object(n["a"])({url:"product/"+t,method:"get"})}function o(){return Object(n["a"])({url:"category",method:"get"})}},6995:function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"container"}},[i("div",{staticClass:"type-search"},[i("div",{staticClass:"search-bar",class:{"is-searching":t.visible}},[i("form",{attrs:{action:""},on:{submit:function(t){t.preventDefault()}}},[i("shop-input",{ref:"searchbar",attrs:{placeholder:"大家都在搜 "+t.placeholder,type:"search",size:"small"},on:{focus:t.handleFocus},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getSearch(e)}},model:{value:t.fetchQuery.name,callback:function(e){t.$set(t.fetchQuery,"name",e)},expression:"fetchQuery.name"}},[i("shop-icon",{attrs:{slot:"prepend",size:"mini",name:"sousuo"},slot:"prepend"})],1)],1)]),t.visible?i("div",{staticClass:"search-btn"},[i("span",{on:{click:t.handelCancel}},[t._v("取消")])]):t._e()]),i("div",{staticClass:"type-menu"},[i("div",{staticClass:"type-menu-bar"},[i("div",{staticClass:"type-menu-bar__item",class:{"is-active":0===t.activeIndex},on:{click:t.changeAll}},[i("div",{staticStyle:{width:"67px",overflow:"hidden"}},[t._v("全部商品")])]),t._l(t.menus,(function(e,n){return i("div",{key:n,staticClass:"type-menu-bar__item",class:{"is-active":t.activeIndex==="m"+n},on:{click:function(i){return t.changeMenu(e,n)}}},[i("div",{staticStyle:{width:"67px",overflow:"hidden"}},[t._v(t._s(e.category_title))])])}))],2),i("div",{staticClass:"type-content",attrs:{id:"content"}},[i("infinite-column",{attrs:{loading:t.loading,nomore:t.noresult,items:t.items,width:t.width,height:t.height},on:{load:t.getItems,cart:t.addCart}},[i("div",{attrs:{slot:"button"},slot:"button"},[i("div",{staticClass:"add-cart-button"},[i("i",{staticClass:"iconfont iconjiahao"})])])])],1)]),i("shop-popup",{attrs:{show:t.popShow,size:"large"},on:{close:t.closePop}},[i("div",{attrs:{slot:"content"},slot:"content"},[i("div",{staticStyle:{"margin-bottom":"20px"}},[i("shop-image",{staticClass:"pop-item-image",attrs:{src:t.currentItem.images[0],width:100,rounded:"",type:"stretch"}},[i("div",{staticClass:"product-image-error",attrs:{slot:"error"},slot:"error"},[i("i",{staticClass:"iconfont icontupian"})])]),i("div",{staticClass:"pop-item-title"},[i("div",[t._v(t._s(t.popLoading?"-":t.currentItem.product.product_title))]),i("div",{staticClass:"pop-item-title__price"},[t._v("¥ "),i("strong",[t._v(t._s(t.popLoading?"-":t.selectVariant.price))])])])],1),i("div",{staticClass:"pop-item-content"},[i("div",{staticClass:"pop-item-content__title"},[t._v("选择规格")]),t.popLoading?i("div",{staticClass:"pop-item-content__content"}):i("div",{staticClass:"pop-item-content__content"},t._l(t.currentItem.variants,(function(e,n){return i("div",{key:n},[i("shop-radio",{attrs:{type:"button",bordered:"",rounded:"",size:"medium",label:e.id},on:{change:function(i){return t.changeVariant(e)}},model:{value:t.selectId,callback:function(e){t.selectId=e},expression:"selectId"}},[t._v(" "+t._s(e.variant_title)+" ")])],1)})),0)]),i("div",{staticClass:"pop-item-content pop-item-content-quantity"},[i("div",{staticClass:"pop-item-content__title"},[t._v("选择数量")]),i("div",{staticClass:"pop-item-content__content"},[i("shop-input-num",{attrs:{value:t.selectNum,max:t.selectVariant.stock,min:1,disabled:!t.selectVariant.stock||t.popLoading},on:{change:t.getNum}})],1)])]),i("div",{attrs:{slot:"button"},slot:"button"},[i("shop-button",{attrs:{rounded:!1,loading:t.btnLoading,disabled:!t.selectVariant.stock||t.popLoading},on:{click:t.confirmAdd}},[t._v(" 加入购物车 ")])],1)])],1)},s=[],a=(i("99af"),i("c975"),i("d81d"),i("b0c0"),i("ac1f"),i("841c"),i("4c79")),o=i("2166"),c=i("76a0"),r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("ul",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMore,expression:"loadMore"}],staticClass:"infinite-shop-list",style:{height:t.height-1+"px"},attrs:{"infinite-scroll-disabled":"loading","infinite-scroll-distance":"10","infinite-scroll-immediate-check":""}},[i("div",{staticStyle:{"min-height":"calc(100% + 1px)"}},[t._l(t.items,(function(e,n){return i("li",{key:n,style:{width:t.width-10+"px"}},[i("div",{on:{click:function(i){return t.toItem(e)}}},[e.saletag?i("div",{staticClass:"infinite-shop-list__saletag"},[i("div",[t._v(t._s(e.saletag))])]):t._e(),1*e.stock===0?i("div",{staticClass:"infinite-shop-list__soldout"},[i("div",[t._v("已抢光")])]):t._e(),i("shop-image",{attrs:{src:e.img,rounded:"",type:"fit",width:90}},[i("div",{staticClass:"product-image-error",attrs:{slot:"error"},slot:"error"},[i("i",{staticClass:"iconfont icontupian"})])])],1),i("div",{style:{width:t.width-120+"px"}},[i("div",{staticClass:"infinite-shop-content__title",on:{click:function(i){return t.toItem(e)}}},[t._v(t._s(e.product_title))]),e.subTitle?i("div",{on:{click:function(i){return t.toItem(e)}}},[i("span",{staticClass:"infinite-shop-content__subtitle"},[t._v(t._s(e.subTitle))])]):t._e(),i("div",{on:{click:function(i){return t.toItem(e)}}},[i("span",{staticClass:"infinite-shop-content__price"},[t._v("¥ "),i("strong",[t._v(t._s(e.price?e.price:"-"))])]),e.oriPrice?i("span",{staticClass:"infinite-shop-content__oriprice"},[t._v("¥ "+t._s(e.oriPrice))]):t._e()]),i("div",{staticClass:"infinite-shop-content__button",on:{click:function(i){return t.addCart(e)}}},[t._t("button")],2)])])})),t.nomore?t._e():i("div",{staticClass:"infinite-shop-list__placeholder"},[t._v(" 加载中... ")]),t.nomore?i("div",{staticClass:"infinite-shop-list__error"},[t._v(" 没有更多了 ")]):t._e()],2)])])},d=[],l=(i("a9e3"),{props:{items:Array,height:{type:Number,default:500},loading:Boolean,nomore:Boolean,width:Number},methods:{loadMore:function(){this.$emit("load")},addCart:function(t){this.$emit("cart",t)},toItem:function(t){void 0!==t.id&&this.$router.push({name:"Product",params:{id:t.id}})}}}),u=l,h=(i("14d6"),i("2877")),p=Object(h["a"])(u,r,d,!1,null,"58b9dab0",null),m=p.exports,f={components:{InfiniteColumn:m},data:function(){return{fetchQuery:{name:"",page:0,pageSize:15,categories:[],Q4S:null},placeholder:"",visible:!1,menus:[],items:[],activeIndex:0,width:0,height:0,loading:!1,noresult:!1,popShow:!1,popLoading:!1,currentItem:{product:{},images:[],variants:[]},selectVariant:{},selectId:null,selectNum:1,btnLoading:!1}},mounted:function(){var t=this;this.$nextTick((function(){t.width=document.getElementById("content").offsetWidth,t.height=document.getElementById("container").offsetHeight-50})),window.onresize=function(){t.width=document.getElementById("content").offsetWidth,t.height=document.getElementById("container").offsetHeight-50}},created:function(){this.getMenus()},beforeRouteLeave:function(t,e,i){"Product"===t.name?e.meta.keepAlive=!0:e.meta.keepAlive=!1,i()},methods:{getMenus:function(){var t=this;Object(a["c"])().then((function(e){t.menus=e.data.body;var i=[];t.menus.map((function(t){i.push(t.id)})),void 0!==t.$route.params.id&&(t.fetchQuery.categories=[],t.fetchQuery.categories.push(t.$route.params.id),t.activeIndex="m"+i.indexOf(t.$route.params.id),t.items=[],t.noresult=!1,t.loading=!1,t.fetchQuery.page=0,t.getItems())}))},changeAll:function(){this.activeIndex=0,this.items=[],this.noresult=!1,this.loading=!1,this.fetchQuery.page=0,this.fetchQuery.categories=[],this.getItems()},changeMenu:function(t,e){this.activeIndex="m"+e,this.items=[],this.noresult=!1,this.loading=!1,this.fetchQuery.page=0,this.fetchQuery.categories=[],this.fetchQuery.categories.push(t.id),this.getItems()},getItems:function(){var t=this;this.loading=!0,this.noresult=!1;var e=[];this.fetchQuery.page+=1,Object(a["b"])(this.fetchQuery).then((function(i){e=i.data.body.data,0===e.length?(t.loading=!0,t.noresult=!0):(t.items=t.items.concat(e),t.loading=!1,t.noresult=!1)})).catch((function(){t.loading=!0,t.noresult=!0}))},addCart:function(t){var e=this;this.popShow=!0,this.popLoading=!0,Object(a["a"])(t.id).then((function(t){var i=[];0!==t.data.body.images.length&&t.data.body.images.map((function(t){i.push(t.url)})),e.currentItem=t.data.body,e.currentItem.images=i,e.selectVariant=e.currentItem.variants[0],e.selectId=e.selectVariant.id,e.popLoading=!1})).catch((function(){e.popLoading=!1}))},closePop:function(){this.popShow=!1,this.currentItem={product:{},variants:[],images:[]},this.selectId=null,this.selectVariant={},this.selectNum=1},confirmAdd:function(){var t=this;this.btnLoading=!0;var e={variant_id:this.selectVariant.id,quantity:this.selectNum};Object(o["a"])(e).then((function(){Object(c["Toast"])("成功加入购物车"),t.btnLoading=!1,t.$store.dispatch("getCart"),t.closePop()})).catch((function(e){401!==e.response.status?Object(c["Toast"])(e.response.data.message):401===e.response.status&&setTimeout((function(){t.$router.push({name:"Login",query:{from:t.$route.name}})}),1e3),t.btnLoading=!1,t.closePop()}))},getSearch:function(){this.fetchQuery.page=0,this.fetchQuery.categories=[],this.activeIndex=0,this.items=[],this.getItems()},handleFocus:function(){this.visible=!0},handelCancel:function(){this.$refs.searchbar.clear(),this.search="",this.visible=!1},changeVariant:function(t){this.selectVariant=t,this.selectId=t.id,this.selectNum=1},getNum:function(t){this.selectNum=t}}},v=f,g=(i("c8e7"),Object(h["a"])(v,n,s,!1,null,"2be9dfd5",null));e["default"]=g.exports},"99af":function(t,e,i){"use strict";var n=i("23e7"),s=i("d039"),a=i("e8b5"),o=i("861d"),c=i("7b0b"),r=i("50c4"),d=i("8418"),l=i("65f0"),u=i("1dde"),h=i("b622"),p=i("2d00"),m=h("isConcatSpreadable"),f=9007199254740991,v="Maximum allowed index exceeded",g=p>=51||!s((function(){var t=[];return t[m]=!1,t.concat()[0]!==t})),_=u("concat"),b=function(t){if(!o(t))return!1;var e=t[m];return void 0!==e?!!e:a(t)},y=!g||!_;n({target:"Array",proto:!0,forced:y},{concat:function(t){var e,i,n,s,a,o=c(this),u=l(o,0),h=0;for(e=-1,n=arguments.length;e<n;e++)if(a=-1===e?o:arguments[e],b(a)){if(s=r(a.length),h+s>f)throw TypeError(v);for(i=0;i<s;i++,h++)i in a&&d(u,h,a[i])}else{if(h>=f)throw TypeError(v);d(u,h++,a)}return u.length=h,u}})},b76d:function(t,e,i){},c8e7:function(t,e,i){"use strict";var n=i("2350"),s=i.n(n);s.a}}]);